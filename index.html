<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="í™‹ì¹´ì´ë„ ì—¬í–‰">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#DFF0FB">
<meta name="description" content="ì¤€ì˜ & ì •ì›ì˜ í™‹ì¹´ì´ë„ ì—¬í–‰ 2026">
<title>í™‹ì¹´ì´ë„ ì—¬í–‰ 2026 â„ï¸</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>â„ï¸</text></svg>">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23DFF0FB' width='100' height='100' rx='20'/><text x='50' y='58' text-anchor='middle' font-size='55'>â„ï¸</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}
html,body{overscroll-behavior:none;overflow-x:hidden}
body{
  font-family:'Noto Sans KR','Apple SD Gothic Neo','Malgun Gothic',sans-serif;
  min-height:100vh;min-height:100dvh;
  background:linear-gradient(180deg,#DFF0FB 0%,#EDE7F3 40%,#F8F5FA 100%);
  color:#2C5F8A;
  padding:0;
  -webkit-font-smoothing:antialiased;
}
::-webkit-scrollbar{display:none}
input,select,button{font-family:inherit;-webkit-appearance:none;appearance:none}
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}
input[type=number]{-moz-appearance:textfield}

/* Snowflakes */
.snow-wrap{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden}
.snowflake{position:absolute;top:-10px;border-radius:50%;background:#fff}

/* Layout */
.app{position:relative;z-index:1;padding:16px 16px calc(env(safe-area-inset-bottom,20px) + 20px);padding-top:max(env(safe-area-inset-top,16px),16px);max-width:500px;margin:0 auto;min-height:100vh;min-height:100dvh}

/* Glass Card */
.glass{background:rgba(255,255,255,.55);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(135,206,250,.3)}

/* Header */
.header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:14px}
.meta{font-size:10px;color:#7BAFD4;font-weight:600;letter-spacing:2px}
.title{font-size:22px;font-weight:900;color:#2C5F8A;margin-top:2px}
.sub{font-size:11px;color:#8BAFC8;margin-top:2px}

/* Buttons */
.btn-primary{background:linear-gradient(135deg,#7BC0F5,#4A9CD9);color:#fff;border:none;border-radius:12px;padding:8px 14px;font-size:12px;font-weight:700;cursor:pointer;box-shadow:0 4px 12px rgba(74,154,217,.3);touch-action:manipulation;transition:transform .1s}
.btn-primary:active{transform:scale(.95)}
.btn-secondary{background:rgba(135,206,250,.2);border:1px solid rgba(135,206,250,.3);border-radius:8px;padding:6px 12px;font-size:11px;font-weight:600;color:#4A8ABF;cursor:pointer;touch-action:manipulation}

/* Clocks */
.clocks{display:flex;gap:10px;margin-bottom:12px}
.clock-card{flex:1;text-align:center;padding:10px 14px}
.clock-label{font-size:11px;color:#6B9CC7;font-weight:600;margin-bottom:2px}
.clock-time{font-size:22px;font-weight:800;color:#2C5F8A;font-variant-numeric:tabular-nums;letter-spacing:1px}

/* Day Tabs */
.day-tabs{display:flex;gap:6px;margin-bottom:14px;overflow-x:auto;padding-bottom:4px;-webkit-overflow-scrolling:touch;scroll-snap-type:x proximity}
.day-tab{flex:0 0 auto;padding:8px 14px;border-radius:12px;cursor:pointer;text-align:center;font-size:12px;font-weight:700;transition:all .2s;touch-action:manipulation;scroll-snap-align:start;border:1px solid rgba(135,206,250,.3);background:rgba(255,255,255,.5);color:#5B8DB8}
.day-tab.active{border:none;background:linear-gradient(135deg,#7BC0F5,#5AADE0);color:#fff;box-shadow:0 4px 12px rgba(74,154,217,.25)}
.day-tab-num{font-weight:700}
.day-tab-date{font-size:10px;opacity:.85;margin-top:1px}

/* Day Header */
.day-header{padding:12px 16px;margin-bottom:14px;display:flex;justify-content:space-between;align-items:center}
.day-title{font-size:16px;font-weight:800;color:#2C5F8A}
.day-sub{font-size:11px;color:#8BAFC8}
.day-cost{text-align:right}
.day-yen{font-size:14px;font-weight:700;color:#2C5F8A}
.day-krw{font-size:10px;color:#8BAFC8}

/* Outfit */
.outfit-title{font-size:13px;font-weight:700;color:#5B8DB8;margin-bottom:8px;display:flex;align-items:center;gap:6px}
.couple-badge{font-size:10px;background:#FFE4EC;color:#D4668A;padding:2px 8px;border-radius:8px;font-weight:600}
.outfit-grid{display:flex;gap:8px;margin-bottom:14px}
.outfit-person{flex:1;text-align:center;padding:12px 10px}
.outfit-name{font-size:12px;font-weight:800;color:#4A8ABF;margin-bottom:10px}
.outfit-items{display:flex;gap:6px}
.outfit-item{flex:1;border-radius:12px;padding:10px 6px}
.outfit-item.top{background:linear-gradient(135deg,#E8F4FD,#D4ECFC)}
.outfit-item.bottom{background:linear-gradient(135deg,#F0E6F6,#E8D8F0)}
.outfit-emoji{font-size:24px;margin-bottom:4px}
.outfit-label{font-size:9px;font-weight:600;margin-bottom:2px}
.outfit-item.top .outfit-label{color:#7BAFD4}
.outfit-item.bottom .outfit-label{color:#A07DBF}
.outfit-text{font-size:10px;font-weight:700;line-height:1.3}
.outfit-item.top .outfit-text{color:#3A7CA5}
.outfit-item.bottom .outfit-text{color:#6D4A8A}

/* TODO */
.todo-title{font-size:13px;font-weight:700;color:#5B8DB8;margin-bottom:8px;display:flex;align-items:center;gap:6px}
.todo-item{display:flex;align-items:center;gap:8px;padding:10px 12px;border-radius:12px;margin-bottom:6px;transition:all .2s;touch-action:manipulation}
.todo-item.unchecked{background:rgba(255,255,255,.55);border:1px solid rgba(135,206,250,.2)}
.todo-item.checked{background:rgba(135,206,250,.12);border:1px solid rgba(135,206,250,.3);opacity:.65}
.checkbox{width:24px;height:24px;border-radius:8px;flex-shrink:0;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;touch-action:manipulation}
.checkbox.off{border:2px solid #A8D4F0;background:#fff}
.checkbox.on{border:none;background:linear-gradient(135deg,#7BC0F5,#4A9CD9)}
.checkbox.on::after{content:'âœ“';color:#fff;font-size:14px;font-weight:800}
.todo-time{width:44px;font-size:12px;font-weight:700;color:#4A8ABF;font-variant-numeric:tabular-nums;flex-shrink:0}
.todo-info{flex:1;min-width:0}
.todo-activity{font-size:12px;font-weight:700;color:#2C5F8A;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.todo-location{font-size:10px;color:#8BAFC8;margin-top:1px}
.checked .todo-time,.checked .todo-activity{text-decoration:line-through;color:#9BBDD4}
.todo-cost{text-align:right;flex-shrink:0}
.cost-yen{font-size:12px;font-weight:700;color:#2C5F8A}
.cost-yen.est{color:#E8A040}
.cost-est{font-size:8px;margin-left:2px}
.cost-free{font-size:10px;color:#B0D0E8;font-weight:600}
.cost-diff{font-size:9px;font-weight:700;margin-top:1px}
.cost-diff.over{color:#E05555}
.cost-diff.under{color:#4A9A5A}

/* Budget Screen */
.budget-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.budget-title{font-size:20px;font-weight:800;color:#2C5F8A}
.rate-bar{padding:14px;margin-bottom:12px;display:flex;align-items:center;justify-content:space-between}
.rate-icon{font-size:20px}
.rate-val{font-size:14px;font-weight:700;color:#2C5F8A}
.rate-time{font-size:10px;color:#8BAFC8}
.summary-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:12px}
.summary-card{border-radius:14px;padding:12px 8px;text-align:center}
.summary-label{font-size:10px;font-weight:600;margin-bottom:4px}
.summary-val{font-size:14px;font-weight:800}
.summary-sub{font-size:10px;opacity:.7;margin-top:2px}
.summary-edit{font-size:8px;color:#A8C0D4;margin-top:2px}
.progress-wrap{padding:10px 14px;margin-bottom:14px}
.progress-top{display:flex;justify-content:space-between;margin-bottom:6px}
.progress-label{font-size:10px;color:#8BAFC8;font-weight:600}
.progress-pct{font-size:10px;font-weight:700}
.progress-bar{height:8px;background:#E8F0F5;border-radius:4px;overflow:hidden}
.progress-fill{height:100%;border-radius:4px;transition:width .5s ease}
.progress-note{font-size:9px;color:#A8C0D4;margin-top:4px;text-align:center}
.input-section{padding:16px;margin-bottom:16px}
.input-title{font-size:14px;font-weight:700;color:#2C5F8A;margin-bottom:12px}
.input-row{display:flex;gap:6px;margin-bottom:4px;flex-wrap:wrap}
.input-row-top{display:flex;gap:6px;width:100%;margin-bottom:6px}
.input-row-bottom{display:flex;gap:6px;width:100%}
.input-select{width:72px;padding:10px 4px;border-radius:10px;border:1px solid #D4E8F5;font-size:12px;outline:none;background:#fff;color:#4A8ABF;font-weight:600}
.input-text{flex:1;padding:10px 12px;border-radius:10px;border:1px solid #D4E8F5;font-size:13px;outline:none;background:#fff}
.input-number{flex:1;padding:10px 12px;border-radius:10px;border:1px solid #D4E8F5;font-size:13px;outline:none;background:#fff}
.input-hint{font-size:10px;color:#A8C0D4;text-align:center;margin-top:4px}
.btn-add{background:linear-gradient(135deg,#7BC0F5,#4A9CD9);color:#fff;border:none;border-radius:10px;padding:10px 14px;font-size:14px;font-weight:700;cursor:pointer;flex-shrink:0;touch-action:manipulation}
.day-budget{padding:12px 14px;margin-bottom:8px}
.day-budget-top{display:flex;justify-content:space-between;align-items:center}
.day-budget-label{font-size:12px;font-weight:700;color:#4A8ABF}
.day-budget-title{font-size:11px;color:#8BAFC8;margin-left:6px}
.day-budget-planned{font-size:11px;color:#8BAFC8}
.day-budget-actual{font-size:12px;font-weight:700;color:#2C5F8A}
.day-budget-diff{font-size:10px;font-weight:700}
.spending-item{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-top:1px solid rgba(135,206,250,.1);font-size:12px}
.spending-name{color:#5B8DB8;flex:1}
.spending-cost{font-weight:600;color:#2C5F8A;font-variant-numeric:tabular-nums}
.spending-krw{font-size:10px;color:#8BAFC8;margin-left:6px}
.btn-delete{border:none;border-radius:6px;padding:2px 6px;font-size:10px;cursor:pointer;font-weight:600;margin-left:6px;transition:all .15s;touch-action:manipulation}
.btn-delete.normal{background:#FFEBEE;color:#D44A4A}
.btn-delete.confirm{background:#D44A4A;color:#fff}
.furukawa-card{background:rgba(129,199,132,.1);border-radius:14px;padding:12px 16px;margin-top:4px;border:1px solid rgba(129,199,132,.25);display:flex;justify-content:space-between;align-items:center}
.furukawa-label{font-size:13px;font-weight:700;color:#4A9A5A}
.furukawa-sub{font-size:10px;color:#8BAFC8}
.budget-edit-input{width:100%;font-size:13px;font-weight:700;text-align:center;border:1px solid #A8D4F0;border-radius:8px;padding:4px;outline:none;background:#fff}
.btn-confirm-budget{margin-top:4px;font-size:10px;background:#4A9CD9;color:#fff;border:none;border-radius:6px;padding:3px 10px;cursor:pointer;font-weight:600}

/* Animations */
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.fade-in{animation:fadeIn .3s ease}

/* Install Banner */
.install-banner{position:fixed;bottom:0;left:0;right:0;z-index:999;padding:16px;padding-bottom:calc(env(safe-area-inset-bottom,16px) + 16px);background:rgba(255,255,255,.95);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-top:1px solid rgba(135,206,250,.3);display:flex;align-items:center;justify-content:space-between;gap:12px}
.install-text{font-size:12px;color:#2C5F8A;font-weight:600}
.install-sub{font-size:10px;color:#8BAFC8;margin-top:2px}
.btn-install{background:linear-gradient(135deg,#7BC0F5,#4A9CD9);color:#fff;border:none;border-radius:10px;padding:10px 16px;font-size:12px;font-weight:700;cursor:pointer;white-space:nowrap}
.btn-dismiss{background:none;border:none;color:#8BAFC8;font-size:11px;cursor:pointer;padding:4px 8px}
.hidden{display:none!important}
</style>
</head>
<body>
<div class="snow-wrap" id="snowWrap"></div>
<div class="app" id="app"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const OUTFITS=[
  {day:1,ì¤€ì˜:{top:"ì²­ë¡ìƒ‰ ë‹ˆíŠ¸",bottom:"ê²€ì • ë°”ì§€",te:"ğŸ§¶",be:"ğŸ‘–"},ì •ì›:{top:"ë‹ˆíŠ¸",bottom:"íšŒìƒ‰ ë°”ì§€",te:"ğŸ§¶",be:"ğŸ‘–"}},
  {day:2,ì¤€ì˜:{top:"ì…”ì¸  + ë…¸ë€ ìŠ¤ì›¨í„°",bottom:"ì²­ë°”ì§€",te:"ğŸ‘”",be:"ğŸ‘–"},ì •ì›:{top:"ë…¸ë€ ìŠ¤ì›¨í„°",bottom:"ì²­ì¹˜ë§ˆ",te:"ğŸ§¶",be:"ğŸ‘—"}},
  {day:3,ì¤€ì˜:{top:"ì…”ì¸  + ê²€ì •ì¡°ë¼",bottom:"ê²€ì • ë°”ì§€",te:"ğŸ¦º",be:"ğŸ‘–"},ì •ì›:{top:"ê²€ì • ì˜¤í”„ìˆ„ë”",bottom:"ì²´í¬ë¬´ëŠ¬ ë¡±ì¹˜ë§ˆ",te:"ğŸ‘š",be:"ğŸ‘—"}},
  {day:4,ì¤€ì˜:{top:"í•˜ëŠ˜ìƒ‰ ìŠ¤ì›¨í„°",bottom:"í° ë°”ì§€",te:"ğŸ§¶",be:"ğŸ‘–"},ì •ì›:{top:"í•˜ëŠ˜ìƒ‰ ìŠ¤ì›¨í„°",bottom:"í° ë°”ì§€",te:"ğŸ§¶",be:"ğŸ‘–"}},
  {day:5,ì¤€ì˜:{top:"íšŒìƒ‰ ì²´í¬ ë§¨íˆ¬ë§¨",bottom:"í° ë°”ì§€",te:"ğŸ‘•",be:"ğŸ‘–"},ì •ì›:{top:"ë‹ˆíŠ¸",bottom:"íšŒìƒ‰ ë°”ì§€",te:"ğŸ§¶",be:"ğŸ‘–"}}
];

const DAYS=[
  {day:1,date:"2/24",wd:"í™”",title:"ì¸ì²œ â†’ ë…¸ë³´ë¦¬ë² ì“°",events:[
    {t:"10:00",a:"ê³µí•­ ë„ì°©",l:"ì¸ì²œê³µí•­",c:0,i:"âœˆï¸"},
    {t:"11:00",a:"ê³µí•­ë°¥",l:"ì¸ì²œê³µí•­",c:1500,i:"ğŸ±",e:1},
    {t:"12:55",a:"ì¶œë°œ",l:"ì¸ì²œ â†’ ì‹ ì¹˜í† ì„¸",c:0,i:"âœˆï¸"},
    {t:"15:40",a:"ì‹ ì¹˜í† ì„¸ ë„ì°©",l:"ì‹ ì¹˜í† ì„¸ ê³µí•­",c:0,i:"ğŸ›¬"},
    {t:"16:30",a:"ê³µí•­â†’ë…¸ë³´ë¦¬ë² ì“°",l:"JR íŠ¹ê¸‰ì—´ì°¨",c:6300,i:"ğŸšƒ"},
    {t:"19:30",a:"ìˆ™ì†Œ ë„ì°©",l:"ë‹¤ì´ì´ì¹˜ ë‹¤í‚¤ëª¨í† ì¹¸",c:30305,i:"ğŸ¨"},
    {t:"20:00",a:"í¸ì˜ì  ì €ë…",l:"í¸ì˜ì ",c:1500,i:"ğŸœ",e:1},
    {t:"21:00",a:"ë°¤ ì§€ì˜¥ê³„ê³¡ ì‚°ì±…",l:"ì§€ì˜¥ê³„ê³¡",c:0,i:"ğŸŒ‹"},
    {t:"22:00",a:"ëŒ€ìš•íƒ• ì˜¨ì²œ",l:"ë‹¤í‚¤ëª¨í† ì¹¸",c:0,i:"â™¨ï¸"}
  ]},
  {day:2,date:"2/25",wd:"ìˆ˜",title:"ë…¸ë³´ë¦¬ë² ì“° â†’ ì‚¿í¬ë¡œ",events:[
    {t:"08:00",a:"ê¸°ìƒ + ì§€ì˜¥ê³„ê³¡",l:"ì§€ì˜¥ê³„ê³¡",c:0,i:"ğŸŒ„"},
    {t:"09:00",a:"ëŒ€ìš•íƒ• ì˜¨ì²œ",l:"ë‹¤í‚¤ëª¨í† ì¹¸",c:0,i:"â™¨ï¸"},
    {t:"10:00",a:"ë§ˆë¦°íŒŒí¬ ë‹‰ìŠ¤",l:"ë…¸ë³´ë¦¬ë² ì“°",c:5600,i:"ğŸ§"},
    {t:"11:00",a:"í­ê·„ì›Œí¬ + ê¸°ì°¨ë°¥",l:"ë§ˆë¦°íŒŒí¬/ì—­",c:1000,i:"ğŸ™",e:1},
    {t:"12:00",a:"ì‚¿í¬ë¡œ ì´ë™",l:"JR íŠ¹ê¸‰ì—´ì°¨",c:3800,i:"ğŸšƒ"},
    {t:"14:30",a:"í˜¸í…” ì²´í¬ì¸",l:"ê²Œì´ì˜¤ í”Œë¼ì",c:42522,i:"ğŸ¨"},
    {t:"15:00",a:"ìˆ˜í”„ì¹´ë ˆí‚¹+ë§¥ì£¼",l:"ìˆ˜í”„ì¹´ë ˆí‚¹",c:4200,i:"ğŸ›"},
    {t:"15:30",a:"ë§ˆì§€ì‚°ë„",l:"ì‚¿í¬ë¡œ ì‹œë‚´",c:1300,i:"ğŸ"},
    {t:"16:00",a:"ë§¥ì£¼ê³µì¥ ê²¬í•™",l:"ì‚¿í¬ë¡œ ë§¥ì£¼ ë°•ë¬¼ê´€",c:1000,i:"ğŸº",e:1},
    {t:"17:00",a:"ì§•ê¸°ìŠ¤ì¹¸ ë§ˆì‚¬ì§„",l:"ìŠ¤ìŠ¤í‚¤ë…¸ ë³¸ì ",c:4200,i:"ğŸ¥©"},
    {t:"19:00",a:"í¸ì˜ì Â·ì•¼ì‹œì¥",l:"ì‚¿í¬ë¡œ ì‹œë‚´",c:1500,i:"ğŸª",e:1}
  ]},
  {day:3,date:"2/26",wd:"ëª©",title:"ì‚¿í¬ë¡œ ì‹œë‚´ ê´€ê´‘",events:[
    {t:"10:00",a:"ê¸°ìƒ",l:"ê²Œì´ì˜¤ í”Œë¼ì",c:0,i:"ğŸ˜´"},
    {t:"11:30",a:"í•´ë¬¼ë®ë°¥",l:"í•´ë¬¼ ë®ë°¥ ì „ë¬¸ì ",c:2500,i:"ğŸ£",e:1},
    {t:"14:30",a:"ë¯¸ì†Œ ë¼ë©˜",l:"ë¼ë©˜ ìš”ì½”ì´ˆ",c:1000,i:"ğŸœ",e:1},
    {t:"15:00",a:"ë‹ˆì¹´ìƒ í¬í† ì¡´",l:"ìŠ¤ìŠ¤í‚¤ë…¸",c:0,i:"ğŸ“¸"},
    {t:"19:00",a:"ì„±ê²Œ ìš”ë¦¬",l:"ìš°ë¯¸ì‚¬ì¿ ë¼",c:9000,i:"ğŸ¦”"},
    {t:"21:00",a:"ì•¼í‚¤ë‹ˆì¿ ",l:"ì¿ ì´í…Œì´/ì‹œë¶€í‚¤",c:12000,i:"ğŸ¥©"},
    {t:"22:30",a:"ëŒ€ê´€ëŒì°¨",l:"ë…¸ë¥´ë² ì‚¬",c:2000,i:"ğŸ¡"},
    {t:"23:00",a:"í¸ì˜ì  í„¸ì´",l:"í¸ì˜ì ",c:1000,i:"ğŸª",e:1}
  ]},
  {day:4,date:"2/27",wd:"ê¸ˆ",title:"ì‚¿í¬ë¡œ â†’ ì˜¤íƒ€ë£¨",events:[
    {t:"10:00",a:"ê¸°ìƒ",l:"ê²Œì´ì˜¤ í”Œë¼ì",c:0,i:"ğŸ˜´"},
    {t:"11:00",a:"ì²´í¬ì•„ì›ƒâ†’ì˜¤íƒ€ë£¨",l:"JR ì¾Œì†",c:3400,i:"ğŸšƒ"},
    {t:"14:00",a:"ì ì‹¬ ì´ˆë°¥",l:"í–¥í† ìš”ë¦¬ ì˜¤ì˜¤í† ë¯¸",c:4000,i:"ğŸ£"},
    {t:"14:30",a:"ì˜¤ë¥´ê³¨ë‹¹ ë³¸ê´€",l:"ì˜¤ë¥´ê³¨ë‹¹",c:0,i:"ğŸµ"},
    {t:"15:00",a:"ì˜¤íƒ€ë£¨ ììœ ì‹œê°„",l:"ì˜¤íƒ€ë£¨ ì‹œë‚´",c:0,i:"ğŸš¶"},
    {t:"16:00",a:"ì „ì„¸íƒ•",l:"ì˜¤íƒ€ë£¨ í›„ë£¨ì¹´ì™€",c:2500,i:"â™¨ï¸"},
    {t:"18:00",a:"ì €ë… ê°€ì´ì„¸í‚¤",l:"ì˜¤íƒ€ë£¨ í›„ë£¨ì¹´ì™€",c:8000,i:"ğŸ½ï¸"},
    {t:"19:00",a:"ì˜¤íƒ€ë£¨ ìš´í•˜ ì•¼ê²½",l:"ì˜¤íƒ€ë£¨ ìš´í•˜",c:0,i:"ğŸŒƒ"}
  ]},
  {day:5,date:"2/28",wd:"í† ",title:"ì˜¤íƒ€ë£¨ â†’ ì¸ì²œ",events:[
    {t:"07:00",a:"ê¸°ìƒ + ì „ì„¸íƒ•",l:"ì˜¤íƒ€ë£¨ í›„ë£¨ì¹´ì™€",c:2500,i:"â™¨ï¸"},
    {t:"09:00",a:"ì•„ì¹¨ ê°€ì´ì„¸í‚¤",l:"ì˜¤íƒ€ë£¨ í›„ë£¨ì¹´ì™€",c:8000,i:"ğŸ½ï¸"},
    {t:"10:30",a:"ì²´í¬ì•„ì›ƒâ†’ê³µí•­",l:"JR (1ì‹œê°„30ë¶„)",c:0,i:"ğŸšƒ"},
    {t:"12:30",a:"ê³µí•­ ë©´ì„¸+ë°¥",l:"ì‹ ì¹˜í† ì„¸ ê³µí•­",c:2000,i:"ğŸ›ï¸",e:1},
    {t:"14:00",a:"ë¹„í–‰ê¸° (ë¨€ë¨€ë¯¸)",l:"ì‹ ì¹˜í† ì„¸â†’ì¸ì²œ",c:0,i:"âœˆï¸"},
    {t:"14:40",a:"ë¹„í–‰ê¸° (ë¼ì§€)",l:"ì‹ ì¹˜í† ì„¸â†’ì¸ì²œ",c:0,i:"âœˆï¸"},
    {t:"17:15",a:"ë„ì°© (ë¨€ë¨€ë¯¸)",l:"ì¸ì²œê³µí•­",c:0,i:"ğŸ›¬"},
    {t:"18:10",a:"ë„ì°© (ë¼ì§€)",l:"ì¸ì²œê³µí•­",c:0,i:"ğŸ›¬"}
  ]}
];
const FURUKAWA=41000;
const RATE_API="https://open.er-api.com/v6/latest/JPY";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const load=(k,d)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):d}catch{return d}};
const save=(k,v)=>{try{localStorage.setItem(k,JSON.stringify(v))}catch{}};
const fmt=n=>n.toLocaleString("ko-KR");

let state={
  activeDay:0,
  showBudget:false,
  checked:load("hk-c",{}),
  rate:load("hk-r",9.36),
  rateTime:load("hk-rt","ê¸°ë³¸ê°’ ì‚¬ìš© ì¤‘"),
  rateLoading:false,
  spending:load("hk-s",[]),
  budget:load("hk-b",200000),
  editingBudget:false,
  budgetInput:"",
  confirmDelete:null,
  inputDay:1,
  inputName:"",
  inputCost:""
};

function setState(patch){
  Object.assign(state,patch);
  render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SNOWFLAKES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initSnow(){
  const w=document.getElementById("snowWrap");
  for(let i=0;i<18;i++){
    const f=document.createElement("div");
    f.className="snowflake";
    const s=2+Math.random()*5,d=7+Math.random()*8,dl=Math.random()*10,l=Math.random()*100,o=.12+Math.random()*0.2,dr=(Math.random()-.5)*30;
    f.style.cssText=`left:${l}%;width:${s}px;height:${s}px;opacity:${o};animation:sf${i} ${d}s linear ${dl}s infinite`;
    w.appendChild(f);
    const style=document.createElement("style");
    style.textContent=`@keyframes sf${i}{0%{transform:translateY(-10px)translateX(0)}50%{transform:translateY(50vh)translateX(${dr}px)}100%{transform:translateY(105vh)translateX(0)}}`;
    document.head.appendChild(style);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CLOCK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateClocks(){
  const n=new Date();
  const o={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:false};
  const kr=document.getElementById("clkKR");
  const jp=document.getElementById("clkJP");
  if(kr)kr.textContent=n.toLocaleTimeString("ko-KR",{timeZone:"Asia/Seoul",...o});
  if(jp)jp.textContent=n.toLocaleTimeString("ko-KR",{timeZone:"Asia/Tokyo",...o});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function refreshRate(){
  setState({rateLoading:true});
  try{
    const r=await fetch(RATE_API);const d=await r.json();
    if(d.rates?.KRW){
      const nr=d.rates.KRW;const t=new Date().toLocaleString("ko-KR")+" ê¸°ì¤€";
      save("hk-r",nr);save("hk-rt",t);
      setState({rate:nr,rateTime:t,rateLoading:false});
      return;
    }
  }catch(e){console.error(e)}
  setState({rateLoading:false});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleCheck(di,ei){
  const k=`${di}-${ei}`;
  state.checked[k]=!state.checked[k];
  save("hk-c",state.checked);
  render();
}

function addSpending(){
  const n=state.inputName.trim(),c=Number(state.inputCost);
  if(!n||!c||c<=0)return;
  const item={id:Date.now(),name:n,cost:c,day:state.inputDay};
  state.spending.push(item);
  save("hk-s",state.spending);
  setState({inputName:"",inputCost:""});
}

function removeSpending(id){
  if(state.confirmDelete!==id){setState({confirmDelete:id});return}
  state.spending=state.spending.filter(x=>x.id!==id);
  save("hk-s",state.spending);
  setState({confirmDelete:null});
}

function saveBudget(){
  const v=Number(state.budgetInput);
  if(v>0){state.budget=v;save("hk-b",v)}
  setState({editingBudget:false});
}

function spendByDay(dn){return state.spending.filter(x=>x.day===dn).reduce((s,x)=>s+x.cost,0)}

function getActual(di,ei){
  const ev=DAYS[di].events[ei];
  if(ev.c===0)return null;
  const m=state.spending.find(x=>x.day===DAYS[di].day&&x.name===ev.a);
  return m?m.cost:null;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function render(){
  const app=document.getElementById("app");
  if(state.showBudget){renderBudget(app);return}
  renderMain(app);
  updateClocks();
}

function renderMain(app){
  const d=DAYS[state.activeDay];
  const o=OUTFITS[state.activeDay];
  const isCouple=o.ì¤€ì˜.top===o.ì •ì›.top&&o.ì¤€ì˜.bottom===o.ì •ì›.bottom;
  const dt=d.events.reduce((s,e)=>s+(e.c||0),0);

  let h=`
  <div class="header fade-in">
    <div>
      <div class="meta">2026.02.24 â€” 02.28</div>
      <div class="title">í™‹ì¹´ì´ë„ ì—¬í–‰ â„ï¸</div>
      <div class="sub">ì¤€ì˜ & ì •ì› Â· 4ë°• 5ì¼</div>
    </div>
    <button class="btn-primary" onclick="setState({showBudget:true})">ğŸ’° ê°€ê³„ë¶€</button>
  </div>

  <div class="clocks">
    <div class="clock-card glass">
      <div class="clock-label">ğŸ‡°ğŸ‡· ëŒ€í•œë¯¼êµ­</div>
      <div class="clock-time" id="clkKR">--:--:--</div>
    </div>
    <div class="clock-card glass">
      <div class="clock-label">ğŸ‡¯ğŸ‡µ ì‚¿í¬ë¡œ</div>
      <div class="clock-time" id="clkJP">--:--:--</div>
    </div>
  </div>

  <div class="day-tabs">
    ${DAYS.map((x,i)=>`
      <div class="day-tab ${state.activeDay===i?'active':''}" onclick="setState({activeDay:${i}})">
        <div class="day-tab-num">Day ${x.day}</div>
        <div class="day-tab-date">${x.date} ${x.wd}</div>
      </div>
    `).join("")}
  </div>

  <div class="glass day-header fade-in">
    <div>
      <div class="day-title">${d.title}</div>
      <div class="day-sub">${d.date} (${d.wd}) Â· ${d.events.length}ê°œ ì¼ì •</div>
    </div>
    <div class="day-cost">
      <div class="day-yen">Â¥${fmt(dt)}</div>
      <div class="day-krw">â‚©${fmt(Math.round(dt*state.rate))}</div>
    </div>
  </div>

  <div class="outfit-title">ğŸ‘— OUTFIT ${isCouple?'<span class="couple-badge">ğŸ’• ì»¤í”Œë£©</span>':''}</div>
  <div class="outfit-grid">
    ${["ì¤€ì˜","ì •ì›"].map(nm=>{
      const p=o[nm];
      return `<div class="glass outfit-person">
        <div class="outfit-name">${nm==="ì¤€ì˜"?"ğŸ§‘ ì¤€ì˜":"ğŸ‘© ì •ì›"}</div>
        <div class="outfit-items">
          <div class="outfit-item top">
            <div class="outfit-emoji">${p.te}</div>
            <div class="outfit-label">ìƒì˜</div>
            <div class="outfit-text">${p.top}</div>
          </div>
          <div class="outfit-item bottom">
            <div class="outfit-emoji">${p.be}</div>
            <div class="outfit-label">í•˜ì˜</div>
            <div class="outfit-text">${p.bottom}</div>
          </div>
        </div>
      </div>`;
    }).join("")}
  </div>

  <div class="todo-title">ğŸ“‹ TO DO</div>
  ${d.events.map((ev,i)=>{
    const ck=!!state.checked[`${state.activeDay}-${i}`];
    const ac=getActual(state.activeDay,i);
    const diff=(ac!==null&&ev.c>0)?ac-ev.c:null;
    return `<div class="todo-item ${ck?'checked':'unchecked'}" onclick="toggleCheck(${state.activeDay},${i})">
      <div class="checkbox ${ck?'on':'off'}"></div>
      <div class="todo-time">${ev.t}</div>
      <div class="todo-info">
        <div class="todo-activity">${ev.i} ${ev.a}</div>
        <div class="todo-location">ğŸ“ ${ev.l}</div>
      </div>
      <div class="todo-cost">
        ${ev.c>0?`
          <div class="cost-yen ${ev.e?'est':''}">Â¥${fmt(ev.c)}${ev.e?'<span class="cost-est">âš¡</span>':''}</div>
          ${diff!==null&&diff!==0?`<div class="cost-diff ${diff>0?'over':'under'}">${diff>0?`+Â¥${fmt(diff)} over`:`-Â¥${fmt(Math.abs(diff))} under`}</div>`:''}
        `:`<div class="cost-free">ë¬´ë£Œ</div>`}
      </div>
    </div>`;
  }).join("")}
  `;
  app.innerHTML=h;
  updateClocks();
}

function renderBudget(app){
  const ts=state.spending.reduce((s,x)=>s+x.cost,0);
  const rem=state.budget-ts;
  const tp=DAYS.reduce((s,d)=>s+d.events.reduce((a,e)=>a+(e.c||0),0),0)+FURUKAWA;
  const pct=state.budget>0?Math.round(ts/state.budget*100):0;
  const pColor=pct>90?"#D44A4A":pct>70?"#E8A040":"#4A8ABF";
  const pBg=pct>90?"linear-gradient(90deg,#E88,#D44)":pct>70?"linear-gradient(90deg,#F0C060,#E8A040)":"linear-gradient(90deg,#7BC0F5,#4A9CD9)";

  let h=`
  <div class="budget-header fade-in">
    <div class="budget-title">ğŸ’° ì—¬í–‰ ê°€ê³„ë¶€</div>
    <button class="btn-primary" onclick="setState({showBudget:false})">ğŸ“… ì¼ì •ìœ¼ë¡œ</button>
  </div>

  <div class="glass rate-bar">
    <div style="display:flex;align-items:center;gap:8px">
      <span class="rate-icon">ğŸ’±</span>
      <div>
        <div class="rate-val">1Â¥ = â‚©${state.rate.toFixed(2)}</div>
        <div class="rate-time">${state.rateTime}</div>
      </div>
    </div>
    <button class="btn-secondary" onclick="refreshRate()" ${state.rateLoading?'disabled':''}>${state.rateLoading?'â³':'ğŸ”„ ìƒˆë¡œê³ ì¹¨'}</button>
  </div>

  <div class="summary-grid">
    <div class="summary-card" style="background:#E8F4FD;cursor:pointer" onclick="setState({editingBudget:true,budgetInput:String(state.budget)})">
      <div class="summary-label" style="color:#4A8ABF">ì²˜ìŒ ê¸ˆì•¡</div>
      ${state.editingBudget?`
        <input class="budget-edit-input" id="budgetInput" type="number" value="${state.budgetInput}" oninput="state.budgetInput=this.value" onkeydown="if(event.key==='Enter')saveBudget()">
        <button class="btn-confirm-budget" onclick="event.stopPropagation();saveBudget()">í™•ì¸</button>
      `:`
        <div class="summary-val" style="color:#4A8ABF">Â¥${fmt(state.budget)}</div>
        <div class="summary-sub" style="color:#4A8ABF">â‚©${fmt(Math.round(state.budget*state.rate))}</div>
        <div class="summary-edit">íƒ­í•˜ì—¬ ìˆ˜ì •</div>
      `}
    </div>
    <div class="summary-card" style="background:#FFF0E0">
      <div class="summary-label" style="color:#D4882A">ì‚¬ìš© ê¸ˆì•¡</div>
      <div class="summary-val" style="color:#D4882A">Â¥${fmt(ts)}</div>
      <div class="summary-sub" style="color:#D4882A">â‚©${fmt(Math.round(ts*state.rate))}</div>
    </div>
    <div class="summary-card" style="background:${rem>=0?'#E8F5E9':'#FFEBEE'}">
      <div class="summary-label" style="color:${rem>=0?'#4A9A5A':'#D44A4A'}">ë‚¨ì€ ê¸ˆì•¡</div>
      <div class="summary-val" style="color:${rem>=0?'#4A9A5A':'#D44A4A'}">Â¥${fmt(Math.abs(rem))}</div>
      <div class="summary-sub" style="color:${rem>=0?'#4A9A5A':'#D44A4A'}">${rem<0?'âš ï¸ ì´ˆê³¼! ':''}â‚©${fmt(Math.round(Math.abs(rem)*state.rate))}</div>
    </div>
  </div>

  <div class="glass progress-wrap">
    <div class="progress-top">
      <span class="progress-label">ì‚¬ìš©ë¥ </span>
      <span class="progress-pct" style="color:${pColor}">${pct}%</span>
    </div>
    <div class="progress-bar"><div class="progress-fill" style="width:${Math.min(100,pct)}%;background:${pBg}"></div></div>
    <div class="progress-note">ê³„íš ì´ì•¡ Â¥${fmt(tp)} (â‚©${fmt(Math.round(tp*state.rate))}) Â· í›„ë£¨ì¹´ì™€ Â¥${fmt(FURUKAWA)} í¬í•¨</div>
  </div>

  <div class="glass input-section">
    <div class="input-title">ğŸ’¸ ì§€ì¶œ ê¸°ë¡</div>
    <div class="input-row">
      <div class="input-row-top">
        <select class="input-select" onchange="state.inputDay=Number(this.value)">
          ${DAYS.map(d=>`<option value="${d.day}" ${state.inputDay===d.day?'selected':''}>Day ${d.day}</option>`).join("")}
        </select>
        <input class="input-text" placeholder="í•­ëª©ëª…" value="${state.inputName}" oninput="state.inputName=this.value" onkeydown="if(event.key==='Enter')document.getElementById('cInput')?.focus()">
      </div>
      <div class="input-row-bottom">
        <input class="input-number" id="cInput" placeholder="Â¥ ê¸ˆì•¡" type="number" value="${state.inputCost}" oninput="state.inputCost=this.value" onkeydown="if(event.key==='Enter')addSpending()">
        <button class="btn-add" onclick="addSpending()">+ ì¶”ê°€</button>
      </div>
    </div>
    <div class="input-hint">í•­ëª©ëª…ì´ TODO ì¼ì •ëª…ê³¼ ê°™ìœ¼ë©´ ìë™ over/under í‘œì‹œ</div>
  </div>

  <div style="font-size:13px;font-weight:700;color:#2C5F8A;margin-bottom:10px">ğŸ“Š ì¼ë³„ ë‚´ì—­</div>
  ${DAYS.map(d=>{
    const pl=d.events.reduce((s,e)=>s+(e.c||0),0);
    const ac=spendByDay(d.day);
    const items=state.spending.filter(x=>x.day===d.day);
    const df=ac-pl;
    return `<div class="glass day-budget">
      <div class="day-budget-top" style="margin-bottom:${items.length?'8':'0'}px">
        <div>
          <span class="day-budget-label">Day ${d.day}</span>
          <span class="day-budget-title">${d.title}</span>
        </div>
        <div style="text-align:right">
          <div class="day-budget-planned">ê³„íš Â¥${fmt(pl)}</div>
          ${ac>0?`<div class="day-budget-actual">ì‹¤ì œ Â¥${fmt(ac)}</div>`:''}
          ${ac>0&&df!==0?`<div class="day-budget-diff" style="color:${df>0?'#E05555':'#4A9A5A'}">${df>0?`â–² Â¥${fmt(df)} over`:`â–¼ Â¥${fmt(Math.abs(df))} under`}</div>`:''}
        </div>
      </div>
      ${items.map(it=>`
        <div class="spending-item">
          <span class="spending-name">${it.name}</span>
          <div style="display:flex;align-items:center;gap:6px">
            <span class="spending-cost">Â¥${fmt(it.cost)}</span>
            <span class="spending-krw">â‚©${fmt(Math.round(it.cost*state.rate))}</span>
            <button class="btn-delete ${state.confirmDelete===it.id?'confirm':'normal'}" onclick="event.stopPropagation();removeSpending(${it.id})">${state.confirmDelete===it.id?'í™•ì¸?':'âœ•'}</button>
          </div>
        </div>
      `).join("")}
    </div>`;
  }).join("")}

  <div class="furukawa-card">
    <div>
      <div class="furukawa-label">ğŸ¯ ì˜¤íƒ€ë£¨ í›„ë£¨ì¹´ì™€</div>
      <div class="furukawa-sub">ìˆ™ë°•ë¹„ (ì „ì„¸íƒ• ë³„ë„ Â¥2,500/íšŒ)</div>
    </div>
    <div style="text-align:right">
      <div style="font-size:14px;font-weight:700;color:#2C5F8A">Â¥${fmt(FURUKAWA)}</div>
      <div style="font-size:10px;color:#8BAFC8">â‚©${fmt(Math.round(FURUKAWA*state.rate))}</div>
    </div>
  </div>
  `;
  app.innerHTML=h;
  if(state.editingBudget){
    const inp=document.getElementById("budgetInput");
    if(inp){inp.focus();inp.select()}
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
initSnow();
render();
setInterval(updateClocks,1000);
refreshRate();

// PWA install prompt
let deferredPrompt;
window.addEventListener('beforeinstallprompt',e=>{
  e.preventDefault();
  deferredPrompt=e;
  showInstallBanner();
});

function showInstallBanner(){
  if(document.querySelector('.install-banner'))return;
  const b=document.createElement('div');
  b.className='install-banner';
  b.innerHTML=`
    <div>
      <div class="install-text">â„ï¸ í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ì‹œê² ì–´ìš”?</div>
      <div class="install-sub">ì•±ì²˜ëŸ¼ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ìš”</div>
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      <button class="btn-install" onclick="installApp()">ì„¤ì¹˜</button>
      <button class="btn-dismiss" onclick="this.parentElement.parentElement.remove()">ë‹«ê¸°</button>
    </div>
  `;
  document.body.appendChild(b);
}

async function installApp(){
  if(!deferredPrompt)return;
  deferredPrompt.prompt();
  const{outcome}=await deferredPrompt.userChoice;
  deferredPrompt=null;
  document.querySelector('.install-banner')?.remove();
}
</script>

<!-- PWA Manifest (inline) -->
<script>
const manifest={
  name:"í™‹ì¹´ì´ë„ ì—¬í–‰ 2026",
  short_name:"í™‹ì¹´ì´ë„",
  description:"ì¤€ì˜ & ì •ì›ì˜ í™‹ì¹´ì´ë„ ì—¬í–‰",
  start_url:"./",
  display:"standalone",
  background_color:"#DFF0FB",
  theme_color:"#DFF0FB",
  orientation:"portrait",
  icons:[{
    src:"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect fill='%23DFF0FB' width='512' height='512' rx='100'/><text x='256' y='300' text-anchor='middle' font-size='280'>â„ï¸</text></svg>",
    sizes:"512x512",
    type:"image/svg+xml",
    purpose:"any maskable"
  }]
};
const blob=new Blob([JSON.stringify(manifest)],{type:'application/json'});
const link=document.createElement('link');
link.rel='manifest';
link.href=URL.createObjectURL(blob);
document.head.appendChild(link);
</script>

<!-- Service Worker (inline registration) -->
<script>
if('serviceWorker' in navigator){
  const swCode=`
    const CACHE='hk-v1';
    self.addEventListener('install',e=>{self.skipWaiting()});
    self.addEventListener('activate',e=>{e.waitUntil(clients.claim())});
    self.addEventListener('fetch',e=>{
      e.respondWith(
        caches.match(e.request).then(r=>r||fetch(e.request).then(res=>{
          if(res.status===200){
            const c=res.clone();
            caches.open(CACHE).then(cache=>cache.put(e.request,c));
          }
          return res;
        }).catch(()=>caches.match(e.request)))
      );
    });
  `;
  const swBlob=new Blob([swCode],{type:'application/javascript'});
  const swUrl=URL.createObjectURL(swBlob);
  navigator.serviceWorker.register(swUrl).catch(()=>{});
}
</script>
</body>
</html>